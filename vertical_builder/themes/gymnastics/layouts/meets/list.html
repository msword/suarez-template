{{ define "main" }}
<section class="page-shell meets-list-page">
  <h1>{{ .Title }}</h1>
  <p class="lead">Meet calendar grouped by year and sorted by start date.</p>

  {{/* Build a sortable list using JSON startDate */}} {{ $rows := slice }} {{
  range where .RegularPages "Draft" false }} {{ $model := partial
  "content_model.html" . }} {{ $status := index $model.data "status" | default
  "active" }} {{ if eq $status "active" }} {{ $start := index $model.data
  "startDate" | default (index $model.data "date" | default "") }} {{ $year :=
  index $model.data "year" | default (cond (ne (printf "%v" $start) "")
  (dateFormat "2006" $start) "â€”") }} {{ $rows = $rows | append (dict "page" .
  "title" $model.title "location" (index $model.data "location" | default
  "Location TBD") "start" (printf "%v" $start) "year" (printf "%v" $year) ) }}
  {{ end }} {{ end }} {{ $sorted := sort $rows "start" "desc" }} {{ $currentYear
  := "" }} {{ range $sorted }} {{ $year := .year }} {{ if ne $year $currentYear
  }} {{ if ne $currentYear "" }}
  <hr class="year-divider" />
  {{ end }}
  <h2 class="year-heading">{{ $year }}</h2>
  {{ $currentYear = $year }} {{ end }}

  <article class="meet-row-card">
    <h3><a href="{{ .page.RelPermalink }}">{{ .title }}</a></h3>
    <p>{{ .location }}</p>
    <p>{{ .start }}</p>
  </article>
  {{ end }}
</section>
{{ end }}
